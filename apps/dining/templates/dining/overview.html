<!-- zamar_springs/apps/dining/templates/dining/overview.html -->
{% extends "dining/base.html" %}
{% load static %}

{% block title %}{{ page_settings.meta_title|default:"Dining Experience" }} | Zamar Springs Gardens{% endblock %}
{% block meta_description %}{{ page_settings.meta_description }}{% endblock %}
{% block meta_keywords %}{{ page_settings.meta_keywords|default:"farm to fork, dining, coffee shop, bbq grill, gazebos, pergola" }}{% endblock %}
{% block og_title %}Dining at Zamar Springs Gardens{% endblock %}
{% block og_description %}Farm-to-fork meals, platter packages, and dining spaces at Zamar Springs Gardens.{% endblock %}
{% block extra_head %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Restaurant",
  "name": "Zamar Springs Gardens Dining",
  "servesCuisine": ["African", "Grill", "Coffee", "Non-Alcoholic"],
  "url": "{{ request.build_absolute_uri }}",
  "menu": "{{ request.scheme }}://{{ request.get_host }}{% url 'dining:menu' %}",
  "telephone": "+254112394681"
}
</script>
{% endblock %}

{% block dining_content %}
<!-- Hero Section -->
<section class="dining-hero">
    <div class="container">
        <div class="dining-hero-content">
            <h1 class="dining-hero-title">{{ page_settings.hero_title }}</h1>
            <p class="dining-hero-subtitle">{{ page_settings.hero_subtitle }}</p>
            <a href="#featured-food" class="btn btn-gold btn-large">
                <i class="fas fa-utensils"></i> View Our Food
            </a>
        </div>
    </div>
</section>

<!-- Introduction -->
<section class="section-padding">
    <div class="container">
        <div class="text-center" style="max-width: 800px; margin: 0 auto;">
            <p class="section-subtitle" style="font-size: 1.25rem; line-height: 1.7;">
                {{ page_settings.intro_text }}
            </p>
        </div>
    </div>
</section>

<!-- Menu Access -->
<section class="section-padding bg-gold-light" id="menu-access">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">View and Download Menu</h2>
            <p class="section-subtitle">Use current menu files now. We will replace with the final menu later.</p>
        </div>
        <div class="pdf-viewer-container">
            <div class="room-actions">
                <a class="btn btn-gold" href="{% static 'menus/Menu-1.pdf' %}" target="_blank" rel="noopener">
                    <i class="fas fa-eye"></i> View Main Menu
                </a>
                <a class="btn btn-outline-gold" href="{% static 'menus/Menu-1.pdf' %}" download>
                    <i class="fas fa-download"></i> Download Main Menu
                </a>
                <a class="btn btn-outline-gold" href="{% static 'menus/platter Menu_20250924_114324_0000.pdf' %}" target="_blank" rel="noopener">
                    <i class="fas fa-plate-wheat"></i> View Platter Menu
                </a>
            </div>
        </div>
    </div>
</section>

<!-- Featured Food -->
<section class="section-padding" id="featured-food">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">Featured Dishes</h2>
            <p class="section-subtitle">Taste our most popular creations</p>
        </div>
        
        {% if featured_food %}
        <div class="food-grid">
            {% for food in featured_food %}
            <div class="food-card {% if food.is_featured %}food-card-featured{% endif %} {% if food.is_special %}food-card-special{% endif %}">
                <div class="food-content">
                    <div class="food-header">
                        <div class="food-visual" aria-hidden="true">
                            <i class="{{ food.category.icon }}"></i>
                        </div>
                        <h3 class="food-title">{{ food.name }}</h3>
                        <p class="food-category">
                            <i class="{{ food.category.icon }}"></i>
                            {{ food.category.name }}
                        </p>
                    </div>
                    
                    <p class="food-description">
                        {{ food.description|truncatewords:20 }}
                    </p>
                    
                    {% if food.is_from_farm and food.farm_ingredients %}
                    <div class="food-ingredients">
                        <p class="food-ingredients-title">
                            <i class="fas fa-seedling nature-icon"></i>
                            Farm Ingredients:
                        </p>
                        <div class="food-ingredients-list">
                            {% for ingredient in food.get_farm_ingredients_list|slice:":3" %}
                            <span class="food-ingredient">{{ ingredient }}</span>
                            {% endfor %}
                            {% if food.get_farm_ingredients_list|length > 3 %}
                            <span class="food-ingredient">+{{ food.get_farm_ingredients_list|length|add:"-3" }} more</span>
                            {% endif %}
                        </div>
                    </div>
                    {% endif %}
                    
                    <div class="food-footer">
                        {% if food.is_from_farm %}
                        <span class="menu-item-ingredient nature-pill">From Our Farm</span>
                        {% endif %}
                        {% if food.price %}
                        <div class="food-price">
                            Ksh {{ food.price|floatformat:0 }}
                        </div>
                        {% else %}
                        <div style="font-style: italic; color: var(--neutral-500);">
                            Price available on request
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <div class="text-center" style="margin-top: var(--space-8);">
            <a href="{% url 'dining:menu' %}" class="btn btn-gold btn-large">
                <i class="fas fa-book-open"></i>
                View Full Menu
            </a>
        </div>
        {% else %}
        <div class="text-center" style="padding: var(--space-12) 0;">
            <i class="fas fa-utensils fa-4x" style="color: var(--neutral-400); margin-bottom: var(--space-4);"></i>
            <h3 style="margin-bottom: var(--space-2); color: var(--neutral-700);">Menu Coming Soon</h3>
            <p style="color: var(--neutral-600); max-width: 400px; margin: 0 auto;">
                We're preparing our delicious offerings. Please check back soon.
            </p>
        </div>
        {% endif %}
    </div>
</section>

<!-- Dining Gallery -->
<section class="section-padding bg-gold-light">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">Dining Spaces Gallery</h2>
            <p class="section-subtitle">Explore Pergola, Gazebos, and Open Air with sliding highlights in each space.</p>
        </div>
        <div class="dining-spaces-grid">
            <article class="space-gallery-card">
                <div class="space-gallery-slider" data-slider>
                    <div class="space-gallery-track">
                        {% for image_url in pergola_gallery_urls %}
                        <div class="space-gallery-slide">
                            <img src="{{ image_url }}" alt="Pergola dining setup at Zamar Springs Gardens" loading="lazy">
                        </div>
                        {% endfor %}
                    </div>
                    <button class="space-gallery-nav prev" type="button" aria-label="Previous Pergola image">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button class="space-gallery-nav next" type="button" aria-label="Next Pergola image">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                <div class="dining-gallery-content">
                    <h3>Pergola</h3>
                    <p>{% if pergola_space %}{{ pergola_space.description|truncatewords:14 }}{% else %}Private meals and small group events in a cozy dining setup.{% endif %}</p>
                </div>
            </article>

            <article class="space-gallery-card">
                <div class="space-gallery-slider" data-slider>
                    <div class="space-gallery-track">
                        {% for image_url in gazebo_gallery_urls %}
                        <div class="space-gallery-slide">
                            <img src="{{ image_url }}" alt="Gazebo dining setup at Zamar Springs Gardens" loading="lazy">
                        </div>
                        {% endfor %}
                    </div>
                    <button class="space-gallery-nav prev" type="button" aria-label="Previous Gazebo image">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button class="space-gallery-nav next" type="button" aria-label="Next Gazebo image">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                <div class="dining-gallery-content">
                    <h3>Gazebos</h3>
                    <p>Multiple gazebo setups represented with sliding images from across the gazebo spaces.</p>
                </div>
            </article>

            <article class="space-gallery-card">
                <div class="space-gallery-slider" data-slider>
                    <div class="space-gallery-track">
                        {% for image_url in open_air_gallery_urls %}
                        <div class="space-gallery-slide">
                            <img src="{{ image_url }}" alt="Open air dining setup at Zamar Springs Gardens" loading="lazy">
                        </div>
                        {% endfor %}
                    </div>
                    <button class="space-gallery-nav prev" type="button" aria-label="Previous Open Air image">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button class="space-gallery-nav next" type="button" aria-label="Next Open Air image">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                <div class="dining-gallery-content">
                    <h3>Open Air</h3>
                    <p>{% if open_air_space %}{{ open_air_space.description|truncatewords:14 }}{% else %}Spacious open-air dining environment for relaxed group experiences.{% endif %}</p>
                </div>
            </article>
        </div>
    </div>
</section>

<!-- Farm to Fork -->
<section class="section-padding bg-dining-secondary">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">{{ page_settings.farm_title }}</h2>
            <p class="section-subtitle">{{ page_settings.farm_subtitle }}</p>
        </div>
        
        {% if farm_sources %}
        <div class="farm-grid">
            {% for source in farm_sources %}
            <div class="farm-card">
                <div class="farm-icon farm-icon-nature">
                    <i class="{{ source.icon }} nature-icon"></i>
                </div>
                <h3 class="farm-title">{{ source.name }}</h3>
                <p class="farm-description">
                    {{ source.description|truncatewords:20 }}
                </p>
            </div>
            {% endfor %}
        </div>
        {% endif %}
        
        <div class="text-center" style="margin-top: var(--space-8);">
            <a href="{% url 'dining:farm_to_fork' %}" class="btn btn-outline-gold">
                <i class="fas fa-seedling nature-icon"></i>
                Learn More About Our Farm
            </a>
        </div>
    </div>
</section>

<!-- Service Zones -->
<section class="section-padding">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">Kitchen, Coffee Shop and Open BBQ Grill</h2>
            <p class="section-subtitle">Core production and service zones behind every dining experience</p>
        </div>
        <div class="farm-grid">
            <div class="farm-card">
                <div class="farm-icon"><i class="fas fa-utensils"></i></div>
                <h3 class="farm-title">Kitchen</h3>
                <p class="farm-description">Main hot kitchen for breakfast, lunch, dinner and family platters.</p>
            </div>
            <div class="farm-card">
                <div class="farm-icon"><i class="fas fa-mug-hot"></i></div>
                <h3 class="farm-title">Coffee Shop</h3>
                <p class="farm-description">Fresh coffee, tea, juices and quick bites served throughout the day.</p>
            </div>
            <div class="farm-card">
                <div class="farm-icon"><i class="fas fa-fire"></i></div>
                <h3 class="farm-title">Open BBQ Grill</h3>
                <p class="farm-description">Live grill for choma and signature roasted selections.</p>
            </div>
        </div>
    </div>
</section>

<!-- Dining Spaces -->
<section class="section-padding" id="spaces">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">{{ page_settings.spaces_title }}</h2>
            <p class="section-subtitle">{{ page_settings.spaces_subtitle }} Tap each section to expand.</p>
        </div>

        <div class="space-accordion">
            <details class="space-expand" open>
                <summary>
                    <span><i class="fas fa-archway"></i> Pergola</span>
                    <span class="space-expand-hint">Private meals and small event meals</span>
                </summary>
                <div class="space-expand-content">
                    <div class="dining-gallery-slider dining-gallery-inline">
                        {% if pergola_space and pergola_space.gallery_images %}
                            {% for image in pergola_space.gallery_images %}
                            <article class="dining-gallery-card">
                                <div class="dining-gallery-image-wrap">
                                    <img src="{{ image.image.url }}" alt="Pergola dining at Zamar Springs Gardens" loading="lazy">
                                </div>
                            </article>
                            {% endfor %}
                        {% elif pergola_space and pergola_space.fallback_gallery %}
                            {% for image_path in pergola_space.fallback_gallery %}
                            <article class="dining-gallery-card">
                                <div class="dining-gallery-image-wrap">
                                    <img src="{{ image_path }}" alt="Pergola dining setup at Zamar Springs Gardens" loading="lazy">
                                </div>
                            </article>
                            {% endfor %}
                        {% endif %}
                    </div>
                    {% if pergola_space %}
                    <p class="space-description">{{ pergola_space.description }}</p>
                    {% endif %}
                </div>
            </details>

            <details class="space-expand">
                <summary>
                    <span><i class="fas fa-umbrella-beach"></i> Gazebos 1-6</span>
                    <span class="space-expand-hint">Flexible garden dining</span>
                </summary>
                <div class="space-expand-content">
                    <div class="space-ideal-list" style="margin-bottom: var(--space-4);">
                        {% for gazebo in gazebo_spaces %}
                        <span class="space-ideal-item">{{ gazebo.name }}</span>
                        {% endfor %}
                    </div>
                    <div class="dining-gallery-slider dining-gallery-inline">
                        {% if gazebo_spaces %}
                            {% for gazebo in gazebo_spaces|slice:":3" %}
                                <article class="dining-gallery-card">
                                    <div class="dining-gallery-image-wrap">
                                        <img src="{{ gazebo.card_image }}" alt="{{ gazebo.name }} at Zamar Springs Gardens" loading="lazy">
                                    </div>
                                </article>
                            {% endfor %}
                        {% else %}
                        <article class="dining-gallery-card">
                            <div class="dining-gallery-image-wrap">
                                <img src="/static/images/web-pictures/gazebo-setup-machakos.webp" alt="Gazebo setup at Zamar Springs Gardens" loading="lazy">
                            </div>
                        </article>
                        {% endif %}
                    </div>
                </div>
            </details>

            <details class="space-expand">
                <summary>
                    <span><i class="fas fa-tree"></i> Open Air</span>
                    <span class="space-expand-hint">Large setup area for tables and seats</span>
                </summary>
                <div class="space-expand-content">
                    <div class="dining-gallery-slider dining-gallery-inline">
                        {% if open_air_space and open_air_space.gallery_images %}
                            {% for image in open_air_space.gallery_images %}
                            <article class="dining-gallery-card">
                                <div class="dining-gallery-image-wrap">
                                    <img src="{{ image.image.url }}" alt="Open Air dining setup at Zamar Springs Gardens" loading="lazy">
                                </div>
                            </article>
                            {% endfor %}
                        {% elif open_air_space and open_air_space.fallback_gallery %}
                            {% for image_path in open_air_space.fallback_gallery %}
                            <article class="dining-gallery-card">
                                <div class="dining-gallery-image-wrap">
                                    <img src="{{ image_path }}" alt="Open Air dining setup at Zamar Springs Gardens" loading="lazy">
                                </div>
                            </article>
                            {% endfor %}
                        {% endif %}
                    </div>
                    {% if open_air_space %}
                    <p class="space-description">{{ open_air_space.description }}</p>
                    {% endif %}
                </div>
            </details>
        </div>
    </div>
</section>

<!-- Custom Menu Requests -->
<section class="section-padding bg-dining-secondary" id="custom-menu">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">Customized Menus on Request</h2>
            <p class="section-subtitle">Zamar Springs Gardens customizes menu combinations for family events, private meals, and group bookings.</p>
        </div>
        <div class="farm-grid">
            <div class="farm-card">
                <div class="farm-icon"><i class="fas fa-sliders"></i></div>
                <h3 class="farm-title">Flexible Portions</h3>
                <p class="farm-description">Adjust serving sizes for small tables, families, and larger groups.</p>
            </div>
            <div class="farm-card">
                <div class="farm-icon farm-icon-nature"><i class="fas fa-seedling nature-icon"></i></div>
                <h3 class="farm-title">Ingredient Preference</h3>
                <p class="farm-description">Tell us your preferred proteins, sides, and farm-fresh vegetable options.</p>
            </div>
            <div class="farm-card">
                <div class="farm-icon"><i class="fas fa-calendar-check"></i></div>
                <h3 class="farm-title">Event-Aligned Menus</h3>
                <p class="farm-description">We align menus to your event type, budget, and service style.</p>
            </div>
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="cta-section">
    <div class="container">
        <div class="cta-content">
            <h2 class="cta-title">Reserve Your Table</h2>
            <p class="cta-subtitle">Experience farm-fresh dining in beautiful surroundings</p>
            
            <div class="cta-actions">
                <a href="tel:+254112394681" class="btn btn-gold btn-large">
                    <i class="fas fa-phone"></i> Call to Reserve
                </a>
                <a href="#reservation" class="btn btn-outline-gold btn-large">
                    <i class="fas fa-calendar-check"></i> Make Reservation
                </a>
            </div>
        </div>
    </div>
</section>

<!-- Reservation Form -->
<section class="section-padding" id="reservation">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">Make a Reservation</h2>
            <p class="section-subtitle">Book your dining experience in advance</p>
        </div>
        
        <div style="max-width: 800px; margin: 0 auto;">
            <form class="booking-form" method="post" action="{% url 'bookings:submit' %}">
                {% csrf_token %}
                <input type="hidden" name="request_type" value="dining_reservation">
                <input type="hidden" name="source_page" value="Dining Overview">
                <input type="hidden" name="next" value="{{ request.get_full_path }}#reservation">
                <div class="booking-form-grid">
                    <div>
                        <h3 style="font-family: var(--font-serif); font-size: 1.5rem; margin-bottom: var(--space-4); color: var(--neutral-900);">
                            Your Details
                        </h3>
                        
                        <div class="booking-form-fields">
                            <div class="form-group">
                                <label for="res_name">Full Name *</label>
                                <input type="text" id="res_name" name="name" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="res_email">Email Address *</label>
                                <input type="email" id="res_email" name="email" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="res_phone">Phone Number *</label>
                                <input type="tel" id="res_phone" name="phone" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="res_guests">Number of Guests *</label>
                                <input type="number" id="res_guests" name="guests" min="1" max="20" required>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 style="font-family: var(--font-serif); font-size: 1.5rem; margin-bottom: var(--space-4); color: var(--neutral-900);">
                            Reservation Details
                        </h3>
                        
                        <div class="booking-form-fields">
                            <div class="form-group">
                                <label for="dining_start_datetime">Event Start *</label>
                                <input type="datetime-local" id="dining_start_datetime" class="event-start-datetime" name="start_datetime" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="dining_end_datetime">Event End *</label>
                                <input type="datetime-local" id="dining_end_datetime" class="event-end-datetime" name="end_datetime" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="res_space">Preferred Dining Space</label>
                                <select id="res_space" name="space">
                                    <option value="">Any available</option>
                                    {% for space in dining_spaces %}
                                    <option value="{{ space.slug }}">{{ space.name }} ({{ space.get_space_type_display }})</option>
                                    {% endfor %}
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="res_custom_menu">Menu Customization *</label>
                                <select id="res_custom_menu" name="menu_customization" required>
                                    <option value="">Select option</option>
                                    <option value="yes">Yes, customize menu for us</option>
                                    <option value="no">No, use standard menu</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="res_notes">Special Requests</label>
                                <textarea id="res_notes" name="notes" rows="3" placeholder="Dietary requirements, platter preference, event details, preferred mains and sides."></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: var(--space-8);">
                    <button type="submit" class="btn btn-gold btn-large">
                        <i class="fas fa-paper-plane"></i>
                        Submit Reservation
                    </button>
                    <p class="reservation-note" style="margin-top: var(--space-3); font-size: 0.875rem;">
                        <i class="fas fa-info-circle"></i>
                        We'll confirm your reservation within 2 hours
                    </p>
                </div>
            </form>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
{{ block.super }}
<script src="{% static 'js/dining-overview.js' %}" defer></script>
{% endblock %}
